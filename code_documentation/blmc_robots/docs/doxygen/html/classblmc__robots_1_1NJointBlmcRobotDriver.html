<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>blmc_robots: blmc_robots::NJointBlmcRobotDriver&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">blmc_robots
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classblmc__robots_1_1NJointBlmcRobotDriver.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classblmc__robots_1_1NJointBlmcRobotDriver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">blmc_robots::NJointBlmcRobotDriver&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt; Class Template Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Base class for n-joint BLMC robots.  
 <a href="classblmc__robots_1_1NJointBlmcRobotDriver.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="n__joint__blmc__robot__driver_8hpp_source.html">n_joint_blmc_robot_driver.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for blmc_robots::NJointBlmcRobotDriver&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classblmc__robots_1_1NJointBlmcRobotDriver__inherit__graph.png" border="0" usemap="#blmc__robots_1_1NJointBlmcRobotDriver_3_01Observation_00_01N__JOINTS_00_01N__MOTOR__BOARDS_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="blmc__robots_1_1NJointBlmcRobotDriver_3_01Observation_00_01N__JOINTS_00_01N__MOTOR__BOARDS_01_4_inherit__map" id="blmc__robots_1_1NJointBlmcRobotDriver_3_01Observation_00_01N__JOINTS_00_01N__MOTOR__BOARDS_01_4_inherit__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for blmc_robots::NJointBlmcRobotDriver&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classblmc__robots_1_1NJointBlmcRobotDriver__coll__graph.png" border="0" usemap="#blmc__robots_1_1NJointBlmcRobotDriver_3_01Observation_00_01N__JOINTS_00_01N__MOTOR__BOARDS_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="blmc__robots_1_1NJointBlmcRobotDriver_3_01Observation_00_01N__JOINTS_00_01N__MOTOR__BOARDS_01_4_coll__map" id="blmc__robots_1_1NJointBlmcRobotDriver_3_01Observation_00_01N__JOINTS_00_01N__MOTOR__BOARDS_01_4_coll__map">
<area shape="rect" id="node3" href="classblmc__robots_1_1BlmcJointModules.html" title="blmc_robots::BlmcJointModules\l\&lt; N_JOINTS \&gt;" alt="" coords="9,86,217,127"/>
<area shape="rect" id="node4" href="structblmc__robots_1_1NJointBlmcRobotDriver_1_1Config.html" title="Configuration of the robot that can be changed by the user. " alt="" coords="5,152,221,208"/>
<area shape="rect" id="node5" href="structblmc__robots_1_1MotorParameters.html" title="Parameters related to the motor. " alt="" coords="13,232,214,259"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structblmc__robots_1_1NJointBlmcRobotDriver_1_1Config.html">Config</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration of the robot that can be changed by the user.  <a href="structblmc__robots_1_1NJointBlmcRobotDriver_1_1Config.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a6c04fde05f933db1703457f94c6cef6b"><td class="memItemLeft" align="right" valign="top"><a id="a6c04fde05f933db1703457f94c6cef6b"></a>
typedef robot_interfaces::NJointAction&lt; N_JOINTS &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>Action</b></td></tr>
<tr class="separator:a6c04fde05f933db1703457f94c6cef6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4827e39990852c1743ce095a74213ac0"><td class="memItemLeft" align="right" valign="top"><a id="a4827e39990852c1743ce095a74213ac0"></a>
typedef robot_interfaces::RobotInterfaceTypes&lt; Action, Observation &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>Types</b></td></tr>
<tr class="separator:a4827e39990852c1743ce095a74213ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdeabef6dc3a084af61da9eda3555083"><td class="memItemLeft" align="right" valign="top"><a id="acdeabef6dc3a084af61da9eda3555083"></a>
typedef Action::Vector&#160;</td><td class="memItemRight" valign="bottom"><b>Vector</b></td></tr>
<tr class="separator:acdeabef6dc3a084af61da9eda3555083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38bce1426a7ad5418dff1d43d0fc338e"><td class="memItemLeft" align="right" valign="top"><a id="a38bce1426a7ad5418dff1d43d0fc338e"></a>
typedef std::array&lt; std::shared_ptr&lt; blmc_drivers::MotorInterface &gt;, N_JOINTS &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>Motors</b></td></tr>
<tr class="separator:a38bce1426a7ad5418dff1d43d0fc338e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab703f92d3c01fbd3d481f886bfb81eca"><td class="memItemLeft" align="right" valign="top"><a id="ab703f92d3c01fbd3d481f886bfb81eca"></a>
typedef std::array&lt; std::shared_ptr&lt; blmc_drivers::CanBusMotorBoard &gt;, N_MOTOR_BOARDS &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>MotorBoards</b></td></tr>
<tr class="separator:ab703f92d3c01fbd3d481f886bfb81eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acc2af471c4db682f57854d14430ef3fa"><td class="memItemLeft" align="right" valign="top"><a id="acc2af471c4db682f57854d14430ef3fa"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>NJointBlmcRobotDriver</b> (const MotorBoards &amp;motor_boards, const Motors &amp;motors, const <a class="el" href="structblmc__robots_1_1MotorParameters.html">MotorParameters</a> &amp;motor_parameters, const <a class="el" href="structblmc__robots_1_1NJointBlmcRobotDriver_1_1Config.html">Config</a> &amp;config)</td></tr>
<tr class="separator:acc2af471c4db682f57854d14430ef3fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfdae3670c639a7dc129e17687b0285"><td class="memItemLeft" align="right" valign="top"><a id="a8bfdae3670c639a7dc129e17687b0285"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_max_torques</b> () const</td></tr>
<tr class="separator:a8bfdae3670c639a7dc129e17687b0285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac3d22be40ce2c6f8bafd901bdb4a3d"><td class="memItemLeft" align="right" valign="top"><a id="a9ac3d22be40ce2c6f8bafd901bdb4a3d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pause_motors</b> ()</td></tr>
<tr class="separator:a9ac3d22be40ce2c6f8bafd901bdb4a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a274d4d97156b77e6f2dcfda74d67e45c"><td class="memItemLeft" align="right" valign="top"><a id="a274d4d97156b77e6f2dcfda74d67e45c"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_measured_index_angles</b> () const</td></tr>
<tr class="separator:a274d4d97156b77e6f2dcfda74d67e45c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a1ece2b5d4f0f607a4d0516543b0d48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#a7a1ece2b5d4f0f607a4d0516543b0d48">initialize</a> () override</td></tr>
<tr class="memdesc:a7a1ece2b5d4f0f607a4d0516543b0d48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find home position of all joints and move to start position.  <a href="#a7a1ece2b5d4f0f607a4d0516543b0d48">More...</a><br /></td></tr>
<tr class="separator:a7a1ece2b5d4f0f607a4d0516543b0d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4c63313e05020b91dad26a580e184f"><td class="memItemLeft" align="right" valign="top"><a id="abc4c63313e05020b91dad26a580e184f"></a>
virtual Observation&#160;</td><td class="memItemRight" valign="bottom"><b>get_latest_observation</b> () override=0</td></tr>
<tr class="separator:abc4c63313e05020b91dad26a580e184f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a200a5a050a1e2d493f47dc1228319d27"><td class="memItemLeft" align="right" valign="top"><a id="a200a5a050a1e2d493f47dc1228319d27"></a>
Action&#160;</td><td class="memItemRight" valign="bottom"><b>apply_action</b> (const Action &amp;desired_action) override</td></tr>
<tr class="separator:a200a5a050a1e2d493f47dc1228319d27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c45384d83e688618a589cb13797e3bc"><td class="memItemLeft" align="right" valign="top"><a id="a2c45384d83e688618a589cb13797e3bc"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>get_error</b> () override</td></tr>
<tr class="separator:a2c45384d83e688618a589cb13797e3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d57e567a2cd393ee9e4af4bcdde94f0"><td class="memItemLeft" align="right" valign="top"><a id="a4d57e567a2cd393ee9e4af4bcdde94f0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>shutdown</b> () override</td></tr>
<tr class="separator:a4d57e567a2cd393ee9e4af4bcdde94f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d9aedee4887a6f34c07481c4520cb5a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#a1d9aedee4887a6f34c07481c4520cb5a">is_within_hard_position_limits</a> (const Observation &amp;observation) const</td></tr>
<tr class="memdesc:a1d9aedee4887a6f34c07481c4520cb5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the joint position is within the hard limits.  <a href="#a1d9aedee4887a6f34c07481c4520cb5a">More...</a><br /></td></tr>
<tr class="separator:a1d9aedee4887a6f34c07481c4520cb5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a30f5a6037441bff26ab208bbb91c0c39"><td class="memItemLeft" align="right" valign="top"><a id="a30f5a6037441bff26ab208bbb91c0c39"></a>
static MotorBoards&#160;</td><td class="memItemRight" valign="bottom"><b>create_motor_boards</b> (const std::array&lt; std::string, N_MOTOR_BOARDS &gt; &amp;can_ports)</td></tr>
<tr class="separator:a30f5a6037441bff26ab208bbb91c0c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f7aaf3bc10c0d4d0f2c7a38f594c166"><td class="memItemLeft" align="right" valign="top">static Action&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#a8f7aaf3bc10c0d4d0f2c7a38f594c166">process_desired_action</a> (const Action &amp;desired_action, const Observation &amp;latest_observation, const double max_torque_Nm, const Vector &amp;safety_kd, const Vector &amp;default_position_control_kp, const Vector &amp;default_position_control_kd, const Vector &amp;lower_position_limits=Vector::Constant(-std::numeric_limits&lt; double &gt;::infinity()), const Vector &amp;upper_position_limits=Vector::Constant(std::numeric_limits&lt; double &gt;::infinity()))</td></tr>
<tr class="memdesc:a8f7aaf3bc10c0d4d0f2c7a38f594c166"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the desired action provided by the user.  <a href="#a8f7aaf3bc10c0d4d0f2c7a38f594c166">More...</a><br /></td></tr>
<tr class="separator:a8f7aaf3bc10c0d4d0f2c7a38f594c166"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a584b85a9e8356e4afcdf1559edd700cc"><td class="memItemLeft" align="right" valign="top">const bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#a584b85a9e8356e4afcdf1559edd700cc">has_endstop_</a></td></tr>
<tr class="memdesc:a584b85a9e8356e4afcdf1559edd700cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the joints have mechanical end stops, false if not.  <a href="#a584b85a9e8356e4afcdf1559edd700cc">More...</a><br /></td></tr>
<tr class="separator:a584b85a9e8356e4afcdf1559edd700cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a933b81d922085d51a8138cbb648c3e64"><td class="memItemLeft" align="right" valign="top"><a id="a933b81d922085d51a8138cbb648c3e64"></a>
static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>num_joints</b> = N_JOINTS</td></tr>
<tr class="separator:a933b81d922085d51a8138cbb648c3e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4897dda6376b6fabdf4b5ecd43c6c4c"><td class="memItemLeft" align="right" valign="top"><a id="ad4897dda6376b6fabdf4b5ecd43c6c4c"></a>
static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>num_motor_boards</b> = N_MOTOR_BOARDS</td></tr>
<tr class="separator:ad4897dda6376b6fabdf4b5ecd43c6c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aeca6dbdd22e3b40afe89fecf2895dcad"><td class="memItemLeft" align="right" valign="top"><a id="aeca6dbdd22e3b40afe89fecf2895dcad"></a>
Action&#160;</td><td class="memItemRight" valign="bottom"><b>apply_action_uninitialized</b> (const Action &amp;desired_action)</td></tr>
<tr class="separator:aeca6dbdd22e3b40afe89fecf2895dcad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafa20130f746b5cc35eae43ce36e23c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#aafa20130f746b5cc35eae43ce36e23c6">_initialize</a> ()</td></tr>
<tr class="memdesc:aafa20130f746b5cc35eae43ce36e23c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actual initialization that is called in a real-time thread in <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#a7a1ece2b5d4f0f607a4d0516543b0d48" title="Find home position of all joints and move to start position. ">initialize()</a>.  <a href="#aafa20130f746b5cc35eae43ce36e23c6">More...</a><br /></td></tr>
<tr class="separator:aafa20130f746b5cc35eae43ce36e23c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2948efef69215afb233fc63acf88d3f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#aa2948efef69215afb233fc63acf88d3f">homing</a> (Vector <a class="el" href="n__joint__blmc__robot__driver_8hpp.html#a8f0c3d2c5211dc9fd38c4d64bdcf77cb">endstop_search_torques_Nm</a>, Vector home_offset_rad=Vector::Zero())</td></tr>
<tr class="memdesc:aa2948efef69215afb233fc63acf88d3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Homing using end stops (optional) and encoder indices.  <a href="#aa2948efef69215afb233fc63acf88d3f">More...</a><br /></td></tr>
<tr class="separator:aa2948efef69215afb233fc63acf88d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab29cab22a765bce463f367b6e6dc82ff"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#ab29cab22a765bce463f367b6e6dc82ff">move_to_position</a> (const Vector &amp;goal_pos, const double tolerance, const uint32_t time_steps)</td></tr>
<tr class="memdesc:ab29cab22a765bce463f367b6e6dc82ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move to given goal position with a minimum jerk trajectory.  <a href="#ab29cab22a765bce463f367b6e6dc82ff">More...</a><br /></td></tr>
<tr class="separator:ab29cab22a765bce463f367b6e6dc82ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a17f32687708f95c1160ecb708d429ccd"><td class="memItemLeft" align="right" valign="top"><a id="a17f32687708f95c1160ecb708d429ccd"></a>
<a class="el" href="classblmc__robots_1_1BlmcJointModules.html">BlmcJointModules</a>&lt; N_JOINTS &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>joint_modules_</b></td></tr>
<tr class="separator:a17f32687708f95c1160ecb708d429ccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad760af5444951e4ce505e45b4e13d4ca"><td class="memItemLeft" align="right" valign="top"><a id="ad760af5444951e4ce505e45b4e13d4ca"></a>
MotorBoards&#160;</td><td class="memItemRight" valign="bottom"><b>motor_boards_</b></td></tr>
<tr class="separator:ad760af5444951e4ce505e45b4e13d4ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e1875908bb62b2f014c3f8dfce969d"><td class="memItemLeft" align="right" valign="top"><a id="ad5e1875908bb62b2f014c3f8dfce969d"></a>
<a class="el" href="structblmc__robots_1_1MotorParameters.html">MotorParameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#ad5e1875908bb62b2f014c3f8dfce969d">motor_parameters_</a></td></tr>
<tr class="memdesc:ad5e1875908bb62b2f014c3f8dfce969d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fixed motor parameters (assuming all joints use same setup). <br /></td></tr>
<tr class="separator:ad5e1875908bb62b2f014c3f8dfce969d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62f708a1406f8dfb68361c5698a5559b"><td class="memItemLeft" align="right" valign="top"><a id="a62f708a1406f8dfb68361c5698a5559b"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#a62f708a1406f8dfb68361c5698a5559b">max_torque_Nm_</a></td></tr>
<tr class="memdesc:a62f708a1406f8dfb68361c5698a5559b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum torque allowed on each joint. <br /></td></tr>
<tr class="separator:a62f708a1406f8dfb68361c5698a5559b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af27a320384e0189725ee1b13edc314"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structblmc__robots_1_1NJointBlmcRobotDriver_1_1Config.html">Config</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#a5af27a320384e0189725ee1b13edc314">config_</a></td></tr>
<tr class="memdesc:a5af27a320384e0189725ee1b13edc314"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined configuration of the driver.  <a href="#a5af27a320384e0189725ee1b13edc314">More...</a><br /></td></tr>
<tr class="separator:a5af27a320384e0189725ee1b13edc314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11037c8c3395fcde191037c82ba6c0a"><td class="memItemLeft" align="right" valign="top"><a id="af11037c8c3395fcde191037c82ba6c0a"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>is_initialized_</b> = false</td></tr>
<tr class="separator:af11037c8c3395fcde191037c82ba6c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt;<br />
class blmc_robots::NJointBlmcRobotDriver&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;</h3>

<p>Base class for n-joint BLMC robots. </p>
<p>This is a generic base class to easily implement drivers for simple BLMC robots that consist of N_JOINTS joints.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">N_JOINTS</td><td>Number of joints. </td></tr>
    <tr><td class="paramname">N_MOTOR_BOARDS</td><td>Number of motor control boards that are used. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aafa20130f746b5cc35eae43ce36e23c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafa20130f746b5cc35eae43ce36e23c6">&#9670;&nbsp;</a></span>_initialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">blmc_robots::NJointBlmcRobotDriver</a>&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;::_initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actual initialization that is called in a real-time thread in <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html#a7a1ece2b5d4f0f607a4d0516543b0d48" title="Find home position of all joints and move to start position. ">initialize()</a>. </p>

</div>
</div>
<a id="aa2948efef69215afb233fc63acf88d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2948efef69215afb233fc63acf88d3f">&#9670;&nbsp;</a></span>homing()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">blmc_robots::NJointBlmcRobotDriver</a>&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;::homing </td>
          <td>(</td>
          <td class="paramtype">Vector&#160;</td>
          <td class="paramname"><em>endstop_search_torques_Nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&#160;</td>
          <td class="paramname"><em>home_offset_rad</em> = <code>Vector::Zero()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Homing using end stops (optional) and encoder indices. </p>
<p>Procedure for finding an absolute zero position (or "home" position) when using relative encoders.</p>
<p>If the robot has end stops (according to configuration), all joints first move in negative direction until they hit the end stop. Then an encoder index search is started where each joint moves slowly in positive direction until the next encoder index. The position of this encoder index is the "home position".</p>
<p>By default, the zero position is the same as the home position. The optional argument home_offset_rad provides a means to move the zero position relative to the home position. The zero position is computed as </p><pre class="fragment">zero position = encoder index position + home offset
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endstop_search_torques_Nm</td><td>Torques that are used to move the joints while searching the end stop. </td></tr>
    <tr><td class="paramname">home_offset_rad</td><td>Offset between the home position and the desired zero position. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7a1ece2b5d4f0f607a4d0516543b0d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a1ece2b5d4f0f607a4d0516543b0d48">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">blmc_robots::NJointBlmcRobotDriver</a>&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find home position of all joints and move to start position. </p>
<p>Homes all joints using home_on_index_after_negative_end_stop. When finished, move the joint to the starting position (defined in <code>config_.initial_position_rad</code>). </p>

</div>
</div>
<a id="a1d9aedee4887a6f34c07481c4520cb5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d9aedee4887a6f34c07481c4520cb5a">&#9670;&nbsp;</a></span>is_within_hard_position_limits()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">blmc_robots::NJointBlmcRobotDriver</a>&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;::is_within_hard_position_limits </td>
          <td>(</td>
          <td class="paramtype">const Observation &amp;&#160;</td>
          <td class="paramname"><em>observation</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the joint position is within the hard limits. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structblmc__robots_1_1NJointBlmcRobotDriver_1_1Config.html#ae34fb8f28bdec0401b72b09bc8d48b65" title="Check if the given position is within the hard limits. ">Config::is_within_hard_position_limits</a> </dd></dl>

</div>
</div>
<a id="ab29cab22a765bce463f367b6e6dc82ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab29cab22a765bce463f367b6e6dc82ff">&#9670;&nbsp;</a></span>move_to_position()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">blmc_robots::NJointBlmcRobotDriver</a>&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;::move_to_position </td>
          <td>(</td>
          <td class="paramtype">const Vector &amp;&#160;</td>
          <td class="paramname"><em>goal_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>time_steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Move to given goal position with a minimum jerk trajectory. </p>
<p>Use a series of position actions to move to the given goal position on a minimum jerk trajectory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">goal_pos</td><td>Angular goal position for each joint. </td></tr>
    <tr><td class="paramname">tolerance</td><td>Allowed position error for reaching the goal. This is checked per joint, that is the maximal possible error is +/-tolerance on each joint. </td></tr>
    <tr><td class="paramname">time_steps</td><td>Number of control loop cycles for reaching the goal. The lower the number of steps, the faster the robot will move. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if goal position is reached, false if timeout is exceeded. </dd></dl>

</div>
</div>
<a id="a8f7aaf3bc10c0d4d0f2c7a38f594c166"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f7aaf3bc10c0d4d0f2c7a38f594c166">&#9670;&nbsp;</a></span>process_desired_action()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static Action <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">blmc_robots::NJointBlmcRobotDriver</a>&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;::process_desired_action </td>
          <td>(</td>
          <td class="paramtype">const Action &amp;&#160;</td>
          <td class="paramname"><em>desired_action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Observation &amp;&#160;</td>
          <td class="paramname"><em>latest_observation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>max_torque_Nm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector &amp;&#160;</td>
          <td class="paramname"><em>safety_kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector &amp;&#160;</td>
          <td class="paramname"><em>default_position_control_kp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector &amp;&#160;</td>
          <td class="paramname"><em>default_position_control_kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector &amp;&#160;</td>
          <td class="paramname"><em>lower_position_limits</em> = <code>Vector::Constant(-std::numeric_limits&lt;&#160;double&#160;&gt;::infinity())</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector &amp;&#160;</td>
          <td class="paramname"><em>upper_position_limits</em> = <code>Vector::Constant(std::numeric_limits&lt;&#160;double&#160;&gt;::infinity())</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the desired action provided by the user. </p>
<p>Takes the desired action from the user and does the following processing:</p>
<h2>1. Check position limits</h2>
<p>If the observed position of a joint exceeds the limits, actions for that joint that do not point back towards the allowed range are replaced with a position command to the limit value. Further custom PD-gains are ignored in this case.</p>
<h2>2. Run the position controller in case a target position is set.</h2>
<p>If the target position is set to a value unequal to NaN for any joint, a PD position controller is executed for this joint and the resulting torque command is added to the torque command in the action.</p>
<p>If the P- and/or D-gains are set to a non-NaN value in the action, they are used for the control. NaN-values are replaced with the default gains.</p>
<h2>3. Apply safety checks.</h2>
<ul>
<li>Limit the torque to the allowed maximum value.</li>
<li>Dampen velocity using the given safety_kd gains. Damping us done joint-wise using this equation: <pre class="fragment">torque_damped = torque_desired - safety_kd * current_velocity
</pre></li>
</ul>
<p>The resulting action with modifications of all steps is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">desired_action</td><td>Desired action given by the user. </td></tr>
    <tr><td class="paramname">latest_observation</td><td>Latest observation from the robot. </td></tr>
    <tr><td class="paramname">max_torque_Nm</td><td>Maximum allowed absolute torque. </td></tr>
    <tr><td class="paramname">safety_kd</td><td>D-gain for velocity damping. </td></tr>
    <tr><td class="paramname">default_position_control_kp</td><td>Default P-gain for position control. </td></tr>
    <tr><td class="paramname">default_position_control_kd</td><td>Default D-gain for position control. </td></tr>
    <tr><td class="paramname">lower_position_limits</td><td>Lower limits for joint positions. </td></tr>
    <tr><td class="paramname">upper_position_limits</td><td>Upper limits for joint positions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Resulting action after applying all the processing. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5af27a320384e0189725ee1b13edc314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5af27a320384e0189725ee1b13edc314">&#9670;&nbsp;</a></span>config_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structblmc__robots_1_1NJointBlmcRobotDriver_1_1Config.html">Config</a> <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">blmc_robots::NJointBlmcRobotDriver</a>&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;::config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>User-defined configuration of the driver. </p>
<p>Contains all configuration values that can be modified by the user (via the configuration file). </p>

</div>
</div>
<a id="a584b85a9e8356e4afcdf1559edd700cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584b85a9e8356e4afcdf1559edd700cc">&#9670;&nbsp;</a></span>has_endstop_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Observation, size_t N_JOINTS, size_t N_MOTOR_BOARDS&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const bool <a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">blmc_robots::NJointBlmcRobotDriver</a>&lt; Observation, N_JOINTS, N_MOTOR_BOARDS &gt;::has_endstop_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if the joints have mechanical end stops, false if not. </p>
<p>If set to true, it is assumed that all joints of the robot have end stops that mechanically prevent them from moving out of the valid range.</p>
<p>If present, the end stops are used for a fully automated homing procedure in which the joints first move until they hit the end stop before starting the encoder index search. This way it is ensured that the correct index is used for homing without any need for manual set up. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/blmc_robots/<a class="el" href="n__joint__blmc__robot__driver_8hpp_source.html">n_joint_blmc_robot_driver.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>blmc_robots</b></li><li class="navelem"><a class="el" href="classblmc__robots_1_1NJointBlmcRobotDriver.html">NJointBlmcRobotDriver</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
